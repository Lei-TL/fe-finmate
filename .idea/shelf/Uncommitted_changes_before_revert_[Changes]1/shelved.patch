Index: app/src/main/res/layout/activity_home.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"?attr/backgroundColor\"\r\n    tools:context=\".ui.activities.HomeActivity\">\r\n\r\n<androidx.core.widget.NestedScrollView\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:fillViewport=\"true\">\r\n\r\n<LinearLayout\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:background=\"?attr/backgroundColor\"\r\n    android:orientation=\"vertical\">\r\n\r\n    <!-- ====== HEADER NGƯỜI DÙNG + MENU 3 CHẤM ====== -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:gravity=\"center_vertical\"\r\n        android:orientation=\"horizontal\"\r\n        android:paddingHorizontal=\"16dp\"\r\n        android:paddingTop=\"16dp\"\r\n        android:paddingBottom=\"12dp\">\r\n\r\n        <!-- Avatar -->\r\n        <ImageView\r\n            android:id=\"@+id/imgAvatar\"\r\n            android:layout_width=\"55dp\"\r\n            android:layout_height=\"55dp\"\r\n            android:layout_marginEnd=\"12dp\"\r\n            android:background=\"@drawable/bg_circle\"\r\n            android:padding=\"5dp\"\r\n            android:src=\"@drawable/taikhoan\"\r\n            android:clickable=\"true\"\r\n            android:focusable=\"true\"\r\n            app:tint=\"@null\"/>\r\n\r\n        <!-- Hello + Name -->\r\n        <LinearLayout\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvHello\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"@string/greeting\"\r\n                android:textColor=\"?attr/colorOnPrimary\"\r\n                android:textSize=\"16sp\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvName\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"\"\r\n                android:textColor=\"?attr/colorOnPrimary\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\" />\r\n        </LinearLayout>\r\n\r\n        <!-- MENU 3 CHẤM -->\r\n        <ImageView\r\n            android:id=\"@+id/btnMenuMore\"\r\n            android:layout_width=\"26dp\"\r\n            android:layout_height=\"26dp\"\r\n            android:padding=\"4dp\"\r\n            android:src=\"@drawable/ic_more_vertical\"\r\n            app:tint=\"#FFFFFF\" />\r\n    </LinearLayout>\r\n\r\n    <!-- ====== FILTER BAR ====== -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\"\r\n        android:paddingHorizontal=\"16dp\"\r\n        android:paddingBottom=\"8dp\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center_vertical\">\r\n\r\n            <!-- Time Filter Button -->\r\n            <com.google.android.material.button.MaterialButton\r\n                android:id=\"@+id/btnTimeFilter\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"@string/today\"\r\n                style=\"@style/Widget.MaterialComponents.Button.TextButton\" />\r\n        </LinearLayout>\r\n\r\n        <!-- Filter Subtitle -->\r\n        <TextView\r\n            android:id=\"@+id/tvCurrentFilter\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"4dp\"\r\n            android:text=\"Tháng 12/2025\"\r\n            android:textColor=\"?attr/textColorSecondary\"\r\n            android:textSize=\"12sp\" />\r\n\r\n        <!-- Sync Status -->\r\n        <TextView\r\n            android:id=\"@+id/tvSyncStatus\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"2dp\"\r\n            android:text=\"\"\r\n            android:textColor=\"?attr/textColorSecondary\"\r\n            android:textSize=\"11sp\" />\r\n    </LinearLayout>\r\n\r\n    <!-- ====== SUMMARY CARDS ====== -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"horizontal\"\r\n        android:paddingHorizontal=\"16dp\"\r\n        android:paddingBottom=\"8dp\">\r\n\r\n        <!-- Balance Card -->\r\n        <LinearLayout\r\n            android:id=\"@+id/cardBalance\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:orientation=\"vertical\"\r\n            android:background=\"@drawable/bg_card\"\r\n            android:backgroundTint=\"?attr/cardBackgroundColor\"\r\n            android:padding=\"16dp\"\r\n            android:layout_marginEnd=\"8dp\"\r\n            android:clickable=\"true\"\r\n            android:focusable=\"true\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\"\r\n                android:gravity=\"center_vertical\">\r\n\r\n                <ImageView\r\n                    android:layout_width=\"16dp\"\r\n                    android:layout_height=\"16dp\"\r\n                    android:src=\"@drawable/ic_wallet\"\r\n                    app:tint=\"?attr/iconTint\"\r\n                    android:layout_marginEnd=\"4dp\" />\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"@string/balance\"\r\n                    android:textColor=\"?attr/textColorSecondary\"\r\n                    android:textSize=\"12sp\" />\r\n            </LinearLayout>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvBalance\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"0 VND\"\r\n                android:textColor=\"?attr/textColorPrimary\"\r\n                android:textSize=\"16sp\"\r\n                android:textStyle=\"bold\"\r\n                android:layout_marginTop=\"4dp\"\r\n                android:maxLines=\"1\"\r\n                android:ellipsize=\"end\"\r\n                android:singleLine=\"true\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvBalanceSubtitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"@string/all_wallets\"\r\n                android:textColor=\"?attr/textColorSecondary\"\r\n                android:textSize=\"11sp\"\r\n                android:layout_marginTop=\"2dp\" />\r\n        </LinearLayout>\r\n\r\n        <!-- Income Card -->\r\n        <LinearLayout\r\n            android:id=\"@+id/cardIncome\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:orientation=\"vertical\"\r\n            android:background=\"@drawable/bg_card\"\r\n            android:backgroundTint=\"?attr/cardBackgroundColor\"\r\n            android:padding=\"16dp\"\r\n            android:layout_marginEnd=\"8dp\"\r\n            android:clickable=\"true\"\r\n            android:focusable=\"true\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\"\r\n                android:gravity=\"center_vertical\">\r\n\r\n                <ImageView\r\n                    android:layout_width=\"16dp\"\r\n                    android:layout_height=\"16dp\"\r\n                    android:src=\"@drawable/ic_arrow_up\"\r\n                    app:tint=\"@color/green_500\"\r\n                    android:layout_marginEnd=\"4dp\" />\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"@string/income\"\r\n                    android:textColor=\"?attr/textColorSecondary\"\r\n                    android:textSize=\"12sp\" />\r\n            </LinearLayout>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvIncome\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"0 VND\"\r\n                android:textColor=\"?attr/textColorPositive\"\r\n                android:textSize=\"16sp\"\r\n                android:textStyle=\"bold\"\r\n                android:layout_marginTop=\"4dp\"\r\n                android:maxLines=\"1\"\r\n                android:ellipsize=\"end\"\r\n                android:singleLine=\"true\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvIncomeSubtitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Trong tháng này\"\r\n                android:textColor=\"?attr/textColorSecondary\"\r\n                android:textSize=\"11sp\"\r\n                android:layout_marginTop=\"2dp\" />\r\n        </LinearLayout>\r\n\r\n        <!-- Expense Card -->\r\n        <LinearLayout\r\n            android:id=\"@+id/cardExpense\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:orientation=\"vertical\"\r\n            android:background=\"@drawable/bg_card\"\r\n            android:backgroundTint=\"?attr/cardBackgroundColor\"\r\n            android:padding=\"16dp\"\r\n            android:clickable=\"true\"\r\n            android:focusable=\"true\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\"\r\n                android:gravity=\"center_vertical\">\r\n\r\n                <ImageView\r\n                    android:layout_width=\"16dp\"\r\n                    android:layout_height=\"16dp\"\r\n                    android:src=\"@drawable/ic_arrow_down\"\r\n                    app:tint=\"@color/red_500\"\r\n                    android:layout_marginEnd=\"4dp\" />\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"@string/expense\"\r\n                    android:textColor=\"?attr/textColorSecondary\"\r\n                    android:textSize=\"12sp\" />\r\n            </LinearLayout>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvExpense\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"0 VND\"\r\n                android:textColor=\"?attr/textColorNegative\"\r\n                android:textSize=\"16sp\"\r\n                android:textStyle=\"bold\"\r\n                android:layout_marginTop=\"4dp\"\r\n                android:maxLines=\"1\"\r\n                android:ellipsize=\"end\"\r\n                android:singleLine=\"true\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvExpenseSubtitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Trong tháng này\"\r\n                android:textColor=\"?attr/textColorSecondary\"\r\n                android:textSize=\"11sp\"\r\n                android:layout_marginTop=\"2dp\" />\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n\r\n    <LinearLayout\r\n        android:id=\"@+id/chartContainer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"210dp\"\r\n        android:layout_margin=\"16dp\"\r\n        android:background=\"@drawable/bg_card\"\r\n        android:backgroundTint=\"?attr/cardBackgroundColor\"\r\n        android:elevation=\"4dp\"\r\n        android:orientation=\"vertical\"\r\n        android:padding=\"12dp\">\r\n\r\n        <TextView\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_gravity=\"center_horizontal\"\r\n            android:text=\"@string/chart_title\"\r\n            android:textColor=\"?attr/textColorSecondary\"\r\n            android:textSize=\"14sp\" />\r\n\r\n        <com.github.mikephil.charting.charts.LineChart\r\n            android:id=\"@+id/lineChart\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_marginTop=\"8dp\" />\r\n    </LinearLayout>\r\n\r\n    <!-- ====== DANH SÁCH GIAO DỊCH ====== -->\r\n    <FrameLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:minHeight=\"400dp\">\r\n\r\n        <androidx.recyclerview.widget.RecyclerView\r\n            android:id=\"@+id/rvTransactions\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:clipToPadding=\"false\"\r\n            android:paddingBottom=\"75dp\"\r\n            android:scrollbars=\"vertical\"\r\n            android:nestedScrollingEnabled=\"false\" />\r\n\r\n        <include\r\n            android:id=\"@+id/layoutEmptyState\"\r\n            layout=\"@layout/layout_empty_state\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:minHeight=\"400dp\"\r\n            android:visibility=\"gone\" />\r\n    </FrameLayout>\r\n\r\n</LinearLayout>\r\n\r\n</androidx.core.widget.NestedScrollView>\r\n\r\n    <com.google.android.material.bottomnavigation.BottomNavigationView\r\n        android:id=\"@+id/bottomNavigation\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"65dp\"\r\n        android:layout_gravity=\"bottom\"\r\n        app:menu=\"@menu/menu_bottom\"\r\n        app:itemIconTint=\"@null\"\r\n        app:itemTextColor=\"@color/bottom_navigation_color\"\r\n        app:itemRippleColor=\"@android:color/transparent\"\r\n        android:background=\"?attr/bottomNavBackgroundColor\"/>\r\n\r\n</androidx.coordinatorlayout.widget.CoordinatorLayout>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_home.xml b/app/src/main/res/layout/activity_home.xml
--- a/app/src/main/res/layout/activity_home.xml	(revision 156bc616bb4c3d046268d7f0400bef81621c2927)
+++ b/app/src/main/res/layout/activity_home.xml	(date 1765516971164)
@@ -5,7 +5,7 @@
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:background="?attr/backgroundColor"
-    tools:context=".ui.activities.HomeActivity">
+    tools:context=".ui.home.HomeActivity">
 
 <androidx.core.widget.NestedScrollView
     android:layout_width="match_parent"
Index: app/src/main/java/com/finmate/core/network/ApiCallExecutor.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.finmate.core.network;\r\n\r\nimport androidx.annotation.NonNull;\r\n\r\nimport com.finmate.data.dto.TokenResponse;\r\nimport com.finmate.data.repository.AuthRepository;\r\n\r\nimport javax.inject.Inject;\r\nimport javax.inject.Singleton;\r\n\r\nimport retrofit2.Call;\r\nimport retrofit2.Callback;\r\nimport retrofit2.Response;\r\n\r\n@Singleton\r\npublic class ApiCallExecutor {\r\n\r\n    private final AuthRepository authRepository;\r\n\r\n    @Inject\r\n    public ApiCallExecutor(AuthRepository authRepository) {\r\n        this.authRepository = authRepository;\r\n    }\r\n\r\n    public <T> void execute(Call<T> call, ApiCallback<T> callback) {\r\n        executeInternal(call, callback, false);\r\n    }\r\n\r\n    private <T> void executeInternal(Call<T> call,\r\n                                     ApiCallback<T> callback,\r\n                                     boolean isRetry) {\r\n\r\n        call.enqueue(new Callback<T>() {\r\n            @Override\r\n            public void onResponse(@NonNull Call<T> call,\r\n                                   @NonNull Response<T> response) {\r\n\r\n                if (response.isSuccessful()) {\r\n                    callback.onSuccess(response.body());\r\n                    return;\r\n                }\r\n\r\n                if (response.code() == 401 && !isRetry) {\r\n                    authRepository.refreshToken(new AuthRepository.RefreshCallback() {\r\n                        @Override\r\n                        public void onSuccess() {\r\n                            Call<T> retryCall = call.clone();\r\n                            executeInternal(retryCall, callback, true);\r\n                        }\r\n\r\n                        @Override\r\n                        public void onError(String message) {\r\n                            callback.onError(\"Refresh token failed: \" + message);\r\n                        }\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                callback.onError(\"Request failed: \" + response.code());\r\n            }\r\n\r\n            @Override\r\n            public void onFailure(@NonNull Call<T> call,\r\n                                  @NonNull Throwable t) {\r\n                callback.onError(t.getMessage());\r\n            }\r\n        });\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/finmate/core/network/ApiCallExecutor.java b/app/src/main/java/com/finmate/core/network/ApiCallExecutor.java
--- a/app/src/main/java/com/finmate/core/network/ApiCallExecutor.java	(revision 156bc616bb4c3d046268d7f0400bef81621c2927)
+++ b/app/src/main/java/com/finmate/core/network/ApiCallExecutor.java	(date 1765517286483)
@@ -29,6 +29,10 @@
     private <T> void executeInternal(Call<T> call,
                                      ApiCallback<T> callback,
                                      boolean isRetry) {
+        
+        if (callback == null) {
+            return; // Early return if callback is null
+        }
 
         call.enqueue(new Callback<T>() {
             @Override
@@ -36,7 +40,13 @@
                                    @NonNull Response<T> response) {
 
                 if (response.isSuccessful()) {
-                    callback.onSuccess(response.body());
+                    T body = response.body();
+                    // Handle cases where response is successful but body is null (e.g., 204 No Content)
+                    if (body == null && response.code() != 204) {
+                        callback.onError("Response body is null");
+                        return;
+                    }
+                    callback.onSuccess(body);
                     return;
                 }
 
@@ -50,7 +60,7 @@
 
                         @Override
                         public void onError(String message) {
-                            callback.onError("Refresh token failed: " + message);
+                            callback.onError("Refresh token failed: " + (message != null ? message : "Unknown error"));
                         }
                     });
                     return;
@@ -62,7 +72,8 @@
             @Override
             public void onFailure(@NonNull Call<T> call,
                                   @NonNull Throwable t) {
-                callback.onError(t.getMessage());
+                String errorMessage = t.getMessage();
+                callback.onError(errorMessage != null ? errorMessage : "Network request failed");
             }
         });
     }
Index: app/src/main/java/com/finmate/data/repository/WalletRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.finmate.data.repository;\r\n\r\nimport android.content.Context;\r\n\r\nimport com.finmate.data.local.database.AppDatabase;\r\nimport com.finmate.data.local.database.dao.WalletDao;\r\nimport com.finmate.data.local.database.entity.WalletEntity;\r\n\r\nimport java.util.List;\r\nimport java.util.concurrent.Executors;\r\n\r\nimport javax.inject.Inject;\r\nimport javax.inject.Singleton;\r\n\r\nimport dagger.hilt.android.qualifiers.ApplicationContext;\r\n\r\n@Singleton\r\npublic class WalletRepository {\r\n\r\n    private final WalletDao dao;\r\n\r\n    @Inject\r\n    public WalletRepository(@ApplicationContext Context context) {\r\n        dao = AppDatabase.getDatabase(context).walletDao();\r\n    }\r\n\r\n    public void insert(WalletEntity wallet) {\r\n        Executors.newSingleThreadExecutor().execute(() ->\r\n                dao.insert(wallet)\r\n        );\r\n    }\r\n\r\n    public void getAll(Callback callback) {\r\n        Executors.newSingleThreadExecutor().execute(() ->\r\n                callback.onResult(dao.getAll())\r\n        );\r\n    }\r\n\r\n    public void replaceAll(List<WalletEntity> wallets) {\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            // Cách đơn giản: xóa hết rồi insert lại\r\n            List<WalletEntity> existing = dao.getAll();\r\n            for (WalletEntity w : existing) {\r\n                dao.delete(w);\r\n            }\r\n            for (WalletEntity w : wallets) {\r\n                dao.insert(w);\r\n            }\r\n        });\r\n    }\r\n\r\n    public interface Callback {\r\n        void onResult(List<WalletEntity> list);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/finmate/data/repository/WalletRepository.java b/app/src/main/java/com/finmate/data/repository/WalletRepository.java
--- a/app/src/main/java/com/finmate/data/repository/WalletRepository.java	(revision 156bc616bb4c3d046268d7f0400bef81621c2927)
+++ b/app/src/main/java/com/finmate/data/repository/WalletRepository.java	(date 1765524617422)
@@ -31,9 +31,14 @@
     }
 
     public void getAll(Callback callback) {
-        Executors.newSingleThreadExecutor().execute(() ->
-                callback.onResult(dao.getAll())
-        );
+        if (callback == null) return;
+        Executors.newSingleThreadExecutor().execute(() -> {
+            try {
+                callback.onResult(dao.getAll());
+            } catch (Exception e) {
+                callback.onResult(null);
+            }
+        });
     }
 
     public void replaceAll(List<WalletEntity> wallets) {
